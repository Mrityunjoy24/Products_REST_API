'use strict';function cov_1c7b4pkkzb(){var path="C:\\Users\\Chotu\\DbprojectCRUD\\controllers\\productController.js";var hash="1d5bb4b2f7f36de1886fd0ea14002a6ccd161a67";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\Chotu\\DbprojectCRUD\\controllers\\productController.js",statementMap:{"0":{start:{line:2,column:13},end:{line:2,column:46}},"1":{start:{line:3,column:14},end:{line:3,column:32}},"2":{start:{line:5,column:26},end:{line:5,column:59}},"3":{start:{line:7,column:0},end:{line:17,column:2}},"4":{start:{line:9,column:4},end:{line:15,column:7}},"5":{start:{line:11,column:8},end:{line:12,column:26}},"6":{start:{line:12,column:12},end:{line:12,column:26}},"7":{start:{line:13,column:8},end:{line:13,column:26}},"8":{start:{line:19,column:0},end:{line:31,column:2}},"9":{start:{line:21,column:20},end:{line:21,column:39}},"10":{start:{line:23,column:4},end:{line:29,column:7}},"11":{start:{line:25,column:8},end:{line:26,column:26}},"12":{start:{line:26,column:12},end:{line:26,column:26}},"13":{start:{line:27,column:8},end:{line:27,column:26}},"14":{start:{line:98,column:0},end:{line:113,column:2}},"15":{start:{line:100,column:22},end:{line:100,column:43}},"16":{start:{line:102,column:4},end:{line:111,column:7}},"17":{start:{line:104,column:8},end:{line:109,column:9}},"18":{start:{line:105,column:12},end:{line:105,column:26}},"19":{start:{line:108,column:12},end:{line:108,column:70}},"20":{start:{line:117,column:0},end:{line:130,column:2}},"21":{start:{line:119,column:13},end:{line:119,column:57}},"22":{start:{line:121,column:4},end:{line:128,column:7}},"23":{start:{line:123,column:8},end:{line:124,column:26}},"24":{start:{line:124,column:12},end:{line:124,column:26}},"25":{start:{line:126,column:8},end:{line:126,column:26}},"26":{start:{line:132,column:0},end:{line:145,column:2}},"27":{start:{line:134,column:13},end:{line:134,column:57}},"28":{start:{line:136,column:4},end:{line:143,column:7}},"29":{start:{line:138,column:8},end:{line:139,column:26}},"30":{start:{line:139,column:12},end:{line:139,column:26}},"31":{start:{line:141,column:8},end:{line:141,column:62}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:7,column:19},end:{line:7,column:20}},loc:{start:{line:7,column:39},end:{line:17,column:1}},line:7},"1":{name:"(anonymous_1)",decl:{start:{line:9,column:17},end:{line:9,column:18}},loc:{start:{line:9,column:41},end:{line:15,column:5}},line:9},"2":{name:"(anonymous_2)",decl:{start:{line:19,column:21},end:{line:19,column:22}},loc:{start:{line:19,column:41},end:{line:31,column:1}},line:19},"3":{name:"(anonymous_3)",decl:{start:{line:23,column:57},end:{line:23,column:58}},loc:{start:{line:23,column:81},end:{line:29,column:5}},line:23},"4":{name:"(anonymous_4)",decl:{start:{line:98,column:14},end:{line:98,column:15}},loc:{start:{line:98,column:34},end:{line:113,column:1}},line:98},"5":{name:"(anonymous_5)",decl:{start:{line:102,column:21},end:{line:102,column:22}},loc:{start:{line:102,column:45},end:{line:111,column:5}},line:102},"6":{name:"(anonymous_6)",decl:{start:{line:117,column:17},end:{line:117,column:18}},loc:{start:{line:117,column:37},end:{line:130,column:1}},line:117},"7":{name:"(anonymous_7)",decl:{start:{line:121,column:67},end:{line:121,column:68}},loc:{start:{line:121,column:91},end:{line:128,column:5}},line:121},"8":{name:"(anonymous_8)",decl:{start:{line:132,column:17},end:{line:132,column:18}},loc:{start:{line:132,column:37},end:{line:145,column:1}},line:132},"9":{name:"(anonymous_9)",decl:{start:{line:136,column:32},end:{line:136,column:33}},loc:{start:{line:136,column:56},end:{line:143,column:5}},line:136}},branchMap:{"0":{loc:{start:{line:11,column:8},end:{line:12,column:26}},type:"if",locations:[{start:{line:11,column:8},end:{line:12,column:26}},{start:{line:11,column:8},end:{line:12,column:26}}],line:11},"1":{loc:{start:{line:25,column:8},end:{line:26,column:26}},type:"if",locations:[{start:{line:25,column:8},end:{line:26,column:26}},{start:{line:25,column:8},end:{line:26,column:26}}],line:25},"2":{loc:{start:{line:104,column:8},end:{line:109,column:9}},type:"if",locations:[{start:{line:104,column:8},end:{line:109,column:9}},{start:{line:104,column:8},end:{line:109,column:9}}],line:104},"3":{loc:{start:{line:123,column:8},end:{line:124,column:26}},type:"if",locations:[{start:{line:123,column:8},end:{line:124,column:26}},{start:{line:123,column:8},end:{line:124,column:26}}],line:123},"4":{loc:{start:{line:138,column:8},end:{line:139,column:26}},type:"if",locations:[{start:{line:138,column:8},end:{line:139,column:26}},{start:{line:138,column:8},end:{line:139,column:26}}],line:138}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"1d5bb4b2f7f36de1886fd0ea14002a6ccd161a67"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1c7b4pkkzb=function(){return actualCoverage;};}return actualCoverage;}cov_1c7b4pkkzb();const dfff=(cov_1c7b4pkkzb().s[0]++,require('dialogflow-fulfillment'));var express=(cov_1c7b4pkkzb().s[1]++,require('express'));//const functions = require('firebase-functions');
const{WebhookClient}=(cov_1c7b4pkkzb().s[2]++,require('dialogflow-fulfillment'));cov_1c7b4pkkzb().s[3]++;exports.products=function(req,res){cov_1c7b4pkkzb().f[0]++;cov_1c7b4pkkzb().s[4]++;Product.find(function(err,product){cov_1c7b4pkkzb().f[1]++;cov_1c7b4pkkzb().s[5]++;if(err){cov_1c7b4pkkzb().b[0][0]++;cov_1c7b4pkkzb().s[6]++;res.send(err);}else{cov_1c7b4pkkzb().b[0][1]++;}cov_1c7b4pkkzb().s[7]++;res.send(product);});};cov_1c7b4pkkzb().s[8]++;exports.getproduct=function(req,res){cov_1c7b4pkkzb().f[2]++;var productId=(cov_1c7b4pkkzb().s[9]++,req.query.productId);cov_1c7b4pkkzb().s[10]++;Product.findById(mongoose.Types.ObjectId(productId),function(err,product){cov_1c7b4pkkzb().f[3]++;cov_1c7b4pkkzb().s[11]++;if(err){cov_1c7b4pkkzb().b[1][0]++;cov_1c7b4pkkzb().s[12]++;res.send(err);}else{cov_1c7b4pkkzb().b[1][1]++;}cov_1c7b4pkkzb().s[13]++;res.json(product);});};// exports.mproduct = function (req, res) {
//     var productId = req.query.productId;
//     Product.findById(mongoose.Types.ObjectId(productId), function (err, product) {
//         if (err)
//             res.send(err);
//         res.json(product);
//     });
// var intentMap = new Map();
// const agent = new dfff.WebhookClient({ request: req, response: res });
// let r=req.body.queryResult.parameters.product;
// //Product.find(function (err, product) {
//     function welcome(agent) {
//         agent.add("Welcome, Im a onlinestore agent!. which phone you want to choose?");
//         // product.forEach(element => {
//         //     //console.log(element.price);
//         //     agent.add(element.product_name);
//         // });
//     }
//     function bookFlight(agent) {
//         agent.add("hello")
//         //agent.add(product);
//     }
//     function fallback(agent) {
//         agent.add("I didn't understand");
//         agent.add("I'm sorry, can you try again?");
//     }
//     function getdetails(agent) {
//         agent.add("Iphone");
//         Product.find({ "product_name": r }, function (err, product) {
//         product.forEach(element => {
//             //console.log(element.price);
//             if (element.product_name === r) {
//                 agent.add("Name: "+element.product_name);
//                 agent.add("Price: "+element.price);
//                 agent.add("Category: "+element.category);
//             }
//         });
//      });
//     }
//     intentMap.set('Default Welcome Intent', welcome);
//     intentMap.set('Default Fallback Intent', fallback);
//     intentMap.set('BookFlight', bookFlight);
//     intentMap.set('Getdetails', getdetails);
//     agent.handleRequest(intentMap);
//});
//}
cov_1c7b4pkkzb().s[14]++;exports.add=function(req,res){cov_1c7b4pkkzb().f[4]++;var new_product=(cov_1c7b4pkkzb().s[15]++,new Product(req.body));cov_1c7b4pkkzb().s[16]++;new_product.save(function(err,product){cov_1c7b4pkkzb().f[5]++;cov_1c7b4pkkzb().s[17]++;if(err){cov_1c7b4pkkzb().b[2][0]++;cov_1c7b4pkkzb().s[18]++;res.send(err);}else{cov_1c7b4pkkzb().b[2][1]++;cov_1c7b4pkkzb().s[19]++;//If no errors, send it back to the client
res.json({message:"Product successfully added!",book});}});};cov_1c7b4pkkzb().s[20]++;exports.update=function(req,res){cov_1c7b4pkkzb().f[6]++;var id=(cov_1c7b4pkkzb().s[21]++,mongoose.Types.ObjectId(req.query.productId));cov_1c7b4pkkzb().s[22]++;Product.findOneAndUpdate({_id:id},req.body,{new:true},function(err,product){cov_1c7b4pkkzb().f[7]++;cov_1c7b4pkkzb().s[23]++;if(err){cov_1c7b4pkkzb().b[3][0]++;cov_1c7b4pkkzb().s[24]++;res.send(err);}else{cov_1c7b4pkkzb().b[3][1]++;}cov_1c7b4pkkzb().s[25]++;res.json(product);});};cov_1c7b4pkkzb().s[26]++;exports.delete=function(req,res){cov_1c7b4pkkzb().f[8]++;var id=(cov_1c7b4pkkzb().s[27]++,mongoose.Types.ObjectId(req.query.productId));cov_1c7b4pkkzb().s[28]++;Product.remove({_id:id},function(err,product){cov_1c7b4pkkzb().f[9]++;cov_1c7b4pkkzb().s[29]++;if(err){cov_1c7b4pkkzb().b[4][0]++;cov_1c7b4pkkzb().s[30]++;res.send(err);}else{cov_1c7b4pkkzb().b[4][1]++;}cov_1c7b4pkkzb().s[31]++;res.json({message:'Product successfully deleted'});});};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInByb2R1Y3RDb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbImRmZmYiLCJyZXF1aXJlIiwiZXhwcmVzcyIsIldlYmhvb2tDbGllbnQiLCJleHBvcnRzIiwicHJvZHVjdHMiLCJyZXEiLCJyZXMiLCJQcm9kdWN0IiwiZmluZCIsImVyciIsInByb2R1Y3QiLCJzZW5kIiwiZ2V0cHJvZHVjdCIsInByb2R1Y3RJZCIsInF1ZXJ5IiwiZmluZEJ5SWQiLCJtb25nb29zZSIsIlR5cGVzIiwiT2JqZWN0SWQiLCJqc29uIiwiYWRkIiwibmV3X3Byb2R1Y3QiLCJib2R5Iiwic2F2ZSIsIm1lc3NhZ2UiLCJib29rIiwidXBkYXRlIiwiaWQiLCJmaW5kT25lQW5kVXBkYXRlIiwiX2lkIiwibmV3IiwiZGVsZXRlIiwicmVtb3ZlIl0sIm1hcHBpbmdzIjoiQUFBQSxhLDRtS0FlWTsyRkFkWixLQUFNQSxDQUFBQSxJQUFJLDBCQUFHQyxPQUFPLENBQUMsd0JBQUQsQ0FBVixDQUFWLENBQ0EsR0FBSUMsQ0FBQUEsT0FBTywwQkFBR0QsT0FBTyxDQUFDLFNBQUQsQ0FBVixDQUFYLENBQ0E7QUFDQSxLQUFNLENBQUVFLGFBQUYsMkJBQW9CRixPQUFPLENBQUMsd0JBQUQsQ0FBM0IsQ0FBTixDLHdCQUVBRyxPQUFPLENBQUNDLFFBQVIsQ0FBbUIsU0FBVUMsR0FBVixDQUFlQyxHQUFmLENBQW9CLGlEQUVuQ0MsT0FBTyxDQUFDQyxJQUFSLENBQWEsU0FBVUMsR0FBVixDQUFlQyxPQUFmLENBQXdCLGlEQUVqQyxHQUFJRCxHQUFKLENBQ0ksb0RBQUFILEdBQUcsQ0FBQ0ssSUFBSixDQUFTRixHQUFULEVBQWMsQ0FEbEIsaUNBRmlDLHdCQUlqQ0gsR0FBRyxDQUFDSyxJQUFKLENBQVNELE9BQVQsRUFFSCxDQU5ELEVBUUgsQ0FWRCxDLHdCQVlBUCxPQUFPLENBQUNTLFVBQVIsQ0FBcUIsU0FBVVAsR0FBVixDQUFlQyxHQUFmLENBQW9CLHlCQUVyQyxHQUFJTyxDQUFBQSxTQUFTLDBCQUFH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ZiA9IHJlcXVpcmUoJ2RpYWxvZ2Zsb3ctZnVsZmlsbG1lbnQnKTtcclxudmFyIGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNzJyk7XHJcbi8vY29uc3QgZnVuY3Rpb25zID0gcmVxdWlyZSgnZmlyZWJhc2UtZnVuY3Rpb25zJyk7XHJcbmNvbnN0IHsgV2ViaG9va0NsaWVudCB9ID0gcmVxdWlyZSgnZGlhbG9nZmxvdy1mdWxmaWxsbWVudCcpO1xyXG5cclxuZXhwb3J0cy5wcm9kdWN0cyA9IGZ1bmN0aW9uIChyZXEsIHJlcykge1xyXG5cclxuICAgIFByb2R1Y3QuZmluZChmdW5jdGlvbiAoZXJyLCBwcm9kdWN0KSB7XHJcblxyXG4gICAgICAgIGlmIChlcnIpXHJcbiAgICAgICAgICAgIHJlcy5zZW5kKGVycik7XHJcbiAgICAgICAgcmVzLnNlbmQocHJvZHVjdCk7XHJcblxyXG4gICAgfSk7XHJcblxyXG59O1xyXG5cclxuZXhwb3J0cy5nZXRwcm9kdWN0ID0gZnVuY3Rpb24gKHJlcSwgcmVzKSB7XHJcblxyXG4gICAgdmFyIHByb2R1Y3RJZCA9IHJlcS5xdWVyeS5wcm9kdWN0SWQ7XHJcblxyXG4gICAgUHJvZHVjdC5maW5kQnlJZChtb25nb29zZS5UeXBlcy5PYmplY3RJZChwcm9kdWN0SWQpLCBmdW5jdGlvbiAoZXJyLCBwcm9kdWN0KSB7XHJcblxyXG4gICAgICAgIGlmIChlcnIpXHJcbiAgICAgICAgICAgIHJlcy5zZW5kKGVycik7XHJcbiAgICAgICAgcmVzLmpzb24ocHJvZHVjdCk7XHJcblxyXG4gICAgfSk7XHJcblxyXG59O1xyXG5cclxuXHJcbi8vIGV4cG9ydHMubXByb2R1Y3QgPSBmdW5jdGlvbiAocmVxLCByZXMpIHtcclxuXHJcbi8vICAgICB2YXIgcHJvZHVjdElkID0gcmVxLnF1ZXJ5LnByb2R1Y3RJZDtcclxuXHJcbi8vICAgICBQcm9kdWN0LmZpbmRCeUlkKG1vbmdvb3NlLlR5cGVzLk9iamVjdElkKHByb2R1Y3RJZCksIGZ1bmN0aW9uIChlcnIsIHByb2R1Y3QpIHtcclxuXHJcbi8vICAgICAgICAgaWYgKGVycilcclxuLy8gICAgICAgICAgICAgcmVzLnNlbmQoZXJyKTtcclxuLy8gICAgICAgICByZXMuanNvbihwcm9kdWN0KTtcclxuXHJcbi8vICAgICB9KTtcclxuICAgIC8vIHZhciBpbnRlbnRNYXAgPSBuZXcgTWFwKCk7XHJcbiAgIFxyXG4gICAgLy8gY29uc3QgYWdlbnQgPSBuZXcgZGZmZi5XZWJob29rQ2xpZW50KHsgcmVxdWVzdDogcmVxLCByZXNwb25zZTogcmVzIH0pO1xyXG4gICAgXHJcbiAgICAvLyBsZXQgcj1yZXEuYm9keS5xdWVyeVJlc3VsdC5wYXJhbWV0ZXJzLnByb2R1Y3Q7XHJcbiAgICAvLyAvL1Byb2R1Y3QuZmluZChmdW5jdGlvbiAoZXJyLCBwcm9kdWN0KSB7XHJcbiAgICAvLyAgICAgZnVuY3Rpb24gd2VsY29tZShhZ2VudCkge1xyXG4gICAgLy8gICAgICAgICBhZ2VudC5hZGQoXCJXZWxjb21lLCBJbSBhIG9ubGluZXN0b3JlIGFnZW50IS4gd2hpY2ggcGhvbmUgeW91IHdhbnQgdG8gY2hvb3NlP1wiKTtcclxuICAgIC8vICAgICAgICAgLy8gcHJvZHVjdC5mb3JFYWNoKGVsZW1lbnQgPT4ge1xyXG4gICAgLy8gICAgICAgICAvLyAgICAgLy9jb25zb2xlLmxvZyhlbGVtZW50LnByaWNlKTtcclxuICAgIC8vICAgICAgICAgLy8gICAgIGFnZW50LmFkZChlbGVtZW50LnByb2R1Y3RfbmFtZSk7XHJcbiAgICAvLyAgICAgICAgIC8vIH0pO1xyXG5cclxuICAgIC8vICAgICB9XHJcblxyXG4gICAgLy8gICAgIGZ1bmN0aW9uIGJvb2tGbGlnaHQoYWdlbnQpIHtcclxuICAgIC8vICAgICAgICAgYWdlbnQuYWRkKFwiaGVsbG9cIilcclxuICAgIC8vICAgICAgICAgLy9hZ2VudC5hZGQocHJvZHVjdCk7XHJcbiAgICAvLyAgICAgfVxyXG5cclxuXHJcbiAgICAvLyAgICAgZnVuY3Rpb24gZmFsbGJhY2soYWdlbnQpIHtcclxuICAgIC8vICAgICAgICAgYWdlbnQuYWRkKFwiSSBkaWRuJ3QgdW5kZXJzdGFuZFwiKTtcclxuICAgIC8vICAgICAgICAgYWdlbnQuYWRkKFwiSSdtIHNvcnJ5LCBjYW4geW91IHRyeSBhZ2Fpbj9cIik7XHJcbiAgICAvLyAgICAgfVxyXG5cclxuXHJcbiAgICAvLyAgICAgZnVuY3Rpb24gZ2V0ZGV0YWlscyhhZ2VudCkge1xyXG4gICAgLy8gICAgICAgICBhZ2VudC5hZGQoXCJJcGhvbmVcIik7XHJcbiAgICAvLyAgICAgICAgIFByb2R1Y3QuZmluZCh7IFwicHJvZHVjdF9uYW1lXCI6IHIgfSwgZnVuY3Rpb24gKGVyciwgcHJvZHVjdCkge1xyXG4gICAgLy8gICAgICAgICBwcm9kdWN0LmZvckVhY2goZWxlbWVudCA9PiB7XHJcbiAgICAvLyAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKGVsZW1lbnQucHJpY2UpO1xyXG4gICAgLy8gICAgICAgICAgICAgaWYgKGVsZW1lbnQucHJvZHVjdF9uYW1lID09PSByKSB7XHJcbiAgICAvLyAgICAgICAgICAgICAgICAgYWdlbnQuYWRkKFwiTmFtZTogXCIrZWxlbWVudC5wcm9kdWN0X25hbWUpO1xyXG4gICAgLy8gICAgICAgICAgICAgICAgIGFnZW50LmFkZChcIlByaWNlOiBcIitlbGVtZW50LnByaWNlKTtcclxuICAgIC8vICAgICAgICAgICAgICAgICBhZ2VudC5hZGQoXCJDYXRlZ29yeTogXCIrZWxlbWVudC5jYXRlZ29yeSk7XHJcbiAgICAvLyAgICAgICAgICAgICB9XHJcbiAgICAvLyAgICAgICAgIH0pO1xyXG4gICAgLy8gICAgICB9KTtcclxuXHJcbiAgICAvLyAgICAgfVxyXG5cclxuXHJcbiAgICAvLyAgICAgaW50ZW50TWFwLnNldCgnRGVmYXVsdCBXZWxjb21lIEludGVudCcsIHdlbGNvbWUpO1xyXG4gICAgLy8gICAgIGludGVudE1hcC5zZXQoJ0RlZmF1bHQgRmFsbGJhY2sgSW50ZW50JywgZmFsbGJhY2spO1xyXG4gICAgLy8gICAgIGludGVudE1hcC5zZXQoJ0Jvb2tGbGlnaHQnLCBib29rRmxpZ2h0KTtcclxuICAgIC8vICAgICBpbnRlbnRNYXAuc2V0KCdHZXRkZXRhaWxzJywgZ2V0ZGV0YWlscyk7XHJcbiAgICAvLyAgICAgYWdlbnQuaGFuZGxlUmVxdWVzdChpbnRlbnRNYXApO1xyXG5cclxuICAgIC8vfSk7XHJcblxyXG4vL31cclxuXHJcbmV4cG9ydHMuYWRkID0gZnVuY3Rpb24gKHJlcSwgcmVzKSB7XHJcblxyXG4gICAgdmFyIG5ld19wcm9kdWN0ID0gbmV3IFByb2R1Y3QocmVxLmJvZHkpO1xyXG5cclxuICAgIG5ld19wcm9kdWN0LnNhdmUoZnVuY3Rpb24gKGVyciwgcHJvZHVjdCkge1xyXG5cclxuICAgICAgICBpZihlcnIpIHtcclxuICAgICAgICAgICAgcmVzLnNlbmQoZXJyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7IC8vSWYgbm8gZXJyb3JzLCBzZW5kIGl0IGJhY2sgdG8gdGhlIGNsaWVudFxyXG4gICAgICAgICAgICByZXMuanNvbih7bWVzc2FnZTogXCJQcm9kdWN0IHN1Y2Nlc3NmdWxseSBhZGRlZCFcIiwgYm9vayB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfSk7XHJcblxyXG59O1xyXG5cclxuXHJcblxyXG5leHBvcnRzLnVwZGF0ZSA9IGZ1bmN0aW9uIChyZXEsIHJlcykge1xyXG5cclxuICAgIHZhciBpZCA9IG1vbmdvb3NlLlR5cGVzLk9iamVjdElkKHJlcS5xdWVyeS5wcm9kdWN0SWQpO1xyXG5cclxuICAgIFByb2R1Y3QuZmluZE9uZUFuZFVwZGF0ZSh7IF9pZDogaWQgfSwgcmVxLmJvZHksIHsgbmV3OiB0cnVlIH0sIGZ1bmN0aW9uIChlcnIsIHByb2R1Y3QpIHtcclxuXHJcbiAgICAgICAgaWYgKGVycilcclxuICAgICAgICAgICAgcmVzLnNlbmQoZXJyKTtcclxuXHJcbiAgICAgICAgcmVzLmpzb24ocHJvZHVjdCk7XHJcblxyXG4gICAgfSk7XHJcblxyXG59O1xyXG5cclxuZXhwb3J0cy5kZWxldGUgPSBmdW5jdGlvbiAocmVxLCByZXMpIHtcclxuXHJcbiAgICB2YXIgaWQgPSBtb25nb29zZS5UeXBlcy5PYmplY3RJZChyZXEucXVlcnkucHJvZHVjdElkKTtcclxuXHJcbiAgICBQcm9kdWN0LnJlbW92ZSh7IF9pZDogaWQgfSwgZnVuY3Rpb24gKGVyciwgcHJvZHVjdCkge1xyXG5cclxuICAgICAgICBpZiAoZXJyKVxyXG4gICAgICAgICAgICByZXMuc2VuZChlcnIpO1xyXG5cclxuICAgICAgICByZXMuanNvbih7IG1lc3NhZ2U6ICdQcm9kdWN0IHN1Y2Nlc3NmdWxseSBkZWxldGVkJyB9KTtcclxuXHJcbiAgICB9KTtcclxuXHJcbn07Il19
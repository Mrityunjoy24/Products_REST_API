'use strict';function cov_1c7b4pkkzb(){var path="C:\\Users\\Chotu\\DbprojectCRUD\\controllers\\productController.js";var hash="2baa999aad6c1196ff6b76fd59846e0c2e999097";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\Chotu\\DbprojectCRUD\\controllers\\productController.js",statementMap:{"0":{start:{line:2,column:13},end:{line:2,column:46}},"1":{start:{line:3,column:14},end:{line:3,column:32}},"2":{start:{line:5,column:26},end:{line:5,column:59}},"3":{start:{line:6,column:15},end:{line:6,column:34}},"4":{start:{line:8,column:0},end:{line:8,column:37}},"5":{start:{line:9,column:0},end:{line:19,column:2}},"6":{start:{line:11,column:4},end:{line:17,column:7}},"7":{start:{line:13,column:8},end:{line:14,column:26}},"8":{start:{line:14,column:12},end:{line:14,column:26}},"9":{start:{line:15,column:8},end:{line:15,column:26}},"10":{start:{line:21,column:0},end:{line:33,column:2}},"11":{start:{line:23,column:20},end:{line:23,column:39}},"12":{start:{line:25,column:4},end:{line:31,column:7}},"13":{start:{line:27,column:8},end:{line:28,column:26}},"14":{start:{line:28,column:12},end:{line:28,column:26}},"15":{start:{line:29,column:8},end:{line:29,column:26}},"16":{start:{line:36,column:0},end:{line:89,column:1}},"17":{start:{line:37,column:20},end:{line:37,column:29}},"18":{start:{line:39,column:18},end:{line:39,column:73}},"19":{start:{line:41,column:10},end:{line:41,column:49}},"20":{start:{line:44,column:12},end:{line:44,column:91}},"21":{start:{line:53,column:12},end:{line:53,column:30}},"22":{start:{line:59,column:12},end:{line:59,column:45}},"23":{start:{line:60,column:12},end:{line:60,column:55}},"24":{start:{line:65,column:12},end:{line:65,column:32}},"25":{start:{line:66,column:12},end:{line:75,column:12}},"26":{start:{line:67,column:12},end:{line:74,column:15}},"27":{start:{line:69,column:16},end:{line:73,column:17}},"28":{start:{line:70,column:20},end:{line:70,column:61}},"29":{start:{line:71,column:20},end:{line:71,column:55}},"30":{start:{line:72,column:20},end:{line:72,column:61}},"31":{start:{line:80,column:8},end:{line:80,column:57}},"32":{start:{line:81,column:8},end:{line:81,column:59}},"33":{start:{line:82,column:8},end:{line:82,column:48}},"34":{start:{line:83,column:8},end:{line:83,column:48}},"35":{start:{line:84,column:8},end:{line:84,column:39}},"36":{start:{line:91,column:0},end:{line:104,column:2}},"37":{start:{line:93,column:22},end:{line:93,column:43}},"38":{start:{line:95,column:4},end:{line:102,column:7}},"39":{start:{line:97,column:8},end:{line:98,column:26}},"40":{start:{line:98,column:12},end:{line:98,column:26}},"41":{start:{line:100,column:8},end:{line:100,column:26}},"42":{start:{line:108,column:0},end:{line:121,column:2}},"43":{start:{line:110,column:13},end:{line:110,column:57}},"44":{start:{line:112,column:4},end:{line:119,column:7}},"45":{start:{line:114,column:8},end:{line:115,column:26}},"46":{start:{line:115,column:12},end:{line:115,column:26}},"47":{start:{line:117,column:8},end:{line:117,column:26}},"48":{start:{line:123,column:0},end:{line:136,column:2}},"49":{start:{line:125,column:13},end:{line:125,column:57}},"50":{start:{line:127,column:4},end:{line:134,column:7}},"51":{start:{line:129,column:8},end:{line:130,column:26}},"52":{start:{line:130,column:12},end:{line:130,column:26}},"53":{start:{line:132,column:8},end:{line:132,column:62}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:9,column:19},end:{line:9,column:20}},loc:{start:{line:9,column:39},end:{line:19,column:1}},line:9},"1":{name:"(anonymous_1)",decl:{start:{line:11,column:17},end:{line:11,column:18}},loc:{start:{line:11,column:41},end:{line:17,column:5}},line:11},"2":{name:"(anonymous_2)",decl:{start:{line:21,column:21},end:{line:21,column:22}},loc:{start:{line:21,column:41},end:{line:33,column:1}},line:21},"3":{name:"(anonymous_3)",decl:{start:{line:25,column:57},end:{line:25,column:58}},loc:{start:{line:25,column:81},end:{line:31,column:5}},line:25},"4":{name:"(anonymous_4)",decl:{start:{line:36,column:19},end:{line:36,column:20}},loc:{start:{line:36,column:39},end:{line:89,column:1}},line:36},"5":{name:"welcome",decl:{start:{line:43,column:17},end:{line:43,column:24}},loc:{start:{line:43,column:32},end:{line:50,column:9}},line:43},"6":{name:"bookFlight",decl:{start:{line:52,column:17},end:{line:52,column:27}},loc:{start:{line:52,column:35},end:{line:55,column:9}},line:52},"7":{name:"fallback",decl:{start:{line:58,column:17},end:{line:58,column:25}},loc:{start:{line:58,column:33},end:{line:61,column:9}},line:58},"8":{name:"getdetails",decl:{start:{line:64,column:17},end:{line:64,column:27}},loc:{start:{line:64,column:35},end:{line:77,column:9}},line:64},"9":{name:"(anonymous_9)",decl:{start:{line:66,column:48},end:{line:66,column:49}},loc:{start:{line:66,column:72},end:{line:75,column:10}},line:66},"10":{name:"(anonymous_10)",decl:{start:{line:67,column:28},end:{line:67,column:29}},loc:{start:{line:67,column:39},end:{line:74,column:13}},line:67},"11":{name:"(anonymous_11)",decl:{start:{line:91,column:14},end:{line:91,column:15}},loc:{start:{line:91,column:34},end:{line:104,column:1}},line:91},"12":{name:"(anonymous_12)",decl:{start:{line:95,column:21},end:{line:95,column:22}},loc:{start:{line:95,column:45},end:{line:102,column:5}},line:95},"13":{name:"(anonymous_13)",decl:{start:{line:108,column:17},end:{line:108,column:18}},loc:{start:{line:108,column:37},end:{line:121,column:1}},line:108},"14":{name:"(anonymous_14)",decl:{start:{line:112,column:67},end:{line:112,column:68}},loc:{start:{line:112,column:91},end:{line:119,column:5}},line:112},"15":{name:"(anonymous_15)",decl:{start:{line:123,column:17},end:{line:123,column:18}},loc:{start:{line:123,column:37},end:{line:136,column:1}},line:123},"16":{name:"(anonymous_16)",decl:{start:{line:127,column:32},end:{line:127,column:33}},loc:{start:{line:127,column:56},end:{line:134,column:5}},line:127}},branchMap:{"0":{loc:{start:{line:13,column:8},end:{line:14,column:26}},type:"if",locations:[{start:{line:13,column:8},end:{line:14,column:26}},{start:{line:13,column:8},end:{line:14,column:26}}],line:13},"1":{loc:{start:{line:27,column:8},end:{line:28,column:26}},type:"if",locations:[{start:{line:27,column:8},end:{line:28,column:26}},{start:{line:27,column:8},end:{line:28,column:26}}],line:27},"2":{loc:{start:{line:69,column:16},end:{line:73,column:17}},type:"if",locations:[{start:{line:69,column:16},end:{line:73,column:17}},{start:{line:69,column:16},end:{line:73,column:17}}],line:69},"3":{loc:{start:{line:97,column:8},end:{line:98,column:26}},type:"if",locations:[{start:{line:97,column:8},end:{line:98,column:26}},{start:{line:97,column:8},end:{line:98,column:26}}],line:97},"4":{loc:{start:{line:114,column:8},end:{line:115,column:26}},type:"if",locations:[{start:{line:114,column:8},end:{line:115,column:26}},{start:{line:114,column:8},end:{line:115,column:26}}],line:114},"5":{loc:{start:{line:129,column:8},end:{line:130,column:26}},type:"if",locations:[{start:{line:129,column:8},end:{line:130,column:26}},{start:{line:129,column:8},end:{line:130,column:26}}],line:129}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"2baa999aad6c1196ff6b76fd59846e0c2e999097"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1c7b4pkkzb=function(){return actualCoverage;};}return actualCoverage;}cov_1c7b4pkkzb();const dfff=(cov_1c7b4pkkzb().s[0]++,require('dialogflow-fulfillment'));var express=(cov_1c7b4pkkzb().s[1]++,require('express'));//const functions = require('firebase-functions');
const{WebhookClient}=(cov_1c7b4pkkzb().s[2]++,require('dialogflow-fulfillment'));var mongoose=(cov_1c7b4pkkzb().s[3]++,require('mongoose'));cov_1c7b4pkkzb().s[4]++;Product=mongoose.model('Products');cov_1c7b4pkkzb().s[5]++;exports.products=function(req,res){cov_1c7b4pkkzb().f[0]++;cov_1c7b4pkkzb().s[6]++;Product.find(function(err,product){cov_1c7b4pkkzb().f[1]++;cov_1c7b4pkkzb().s[7]++;if(err){cov_1c7b4pkkzb().b[0][0]++;cov_1c7b4pkkzb().s[8]++;res.send(err);}else{cov_1c7b4pkkzb().b[0][1]++;}cov_1c7b4pkkzb().s[9]++;res.send(product);});};cov_1c7b4pkkzb().s[10]++;exports.getproduct=function(req,res){cov_1c7b4pkkzb().f[2]++;var productId=(cov_1c7b4pkkzb().s[11]++,req.query.productId);cov_1c7b4pkkzb().s[12]++;Product.findById(mongoose.Types.ObjectId(productId),function(err,product){cov_1c7b4pkkzb().f[3]++;cov_1c7b4pkkzb().s[13]++;if(err){cov_1c7b4pkkzb().b[1][0]++;cov_1c7b4pkkzb().s[14]++;res.send(err);}else{cov_1c7b4pkkzb().b[1][1]++;}cov_1c7b4pkkzb().s[15]++;res.json(product);});};cov_1c7b4pkkzb().s[16]++;exports.mproduct=function(req,res){cov_1c7b4pkkzb().f[4]++;var intentMap=(cov_1c7b4pkkzb().s[17]++,new Map());const agent=(cov_1c7b4pkkzb().s[18]++,new dfff.WebhookClient({request:req,response:res}));let r=(cov_1c7b4pkkzb().s[19]++,req.body.queryResult.parameters.product);//Product.find(function (err, product) {
function welcome(agent){cov_1c7b4pkkzb().f[5]++;cov_1c7b4pkkzb().s[20]++;agent.add("Welcome, Im a onlinestore agent!. which phone you want to choose?");// product.forEach(element => {
//     //console.log(element.price);
//     agent.add(element.product_name);
// });
}function bookFlight(agent){cov_1c7b4pkkzb().f[6]++;cov_1c7b4pkkzb().s[21]++;agent.add("hello");//agent.add(product);
}function fallback(agent){cov_1c7b4pkkzb().f[7]++;cov_1c7b4pkkzb().s[22]++;agent.add("I didn't understand");cov_1c7b4pkkzb().s[23]++;agent.add("I'm sorry, can you try again?");}function getdetails(agent){cov_1c7b4pkkzb().f[8]++;cov_1c7b4pkkzb().s[24]++;agent.add("Iphone");cov_1c7b4pkkzb().s[25]++;Product.find({"product_name":r},function(err,product){cov_1c7b4pkkzb().f[9]++;cov_1c7b4pkkzb().s[26]++;product.forEach(element=>{cov_1c7b4pkkzb().f[10]++;cov_1c7b4pkkzb().s[27]++;//console.log(element.price);
if(element.product_name===r){cov_1c7b4pkkzb().b[2][0]++;cov_1c7b4pkkzb().s[28]++;agent.add("Name: "+element.product_name);cov_1c7b4pkkzb().s[29]++;agent.add("Price: "+element.price);cov_1c7b4pkkzb().s[30]++;agent.add("Category: "+element.category);}else{cov_1c7b4pkkzb().b[2][1]++;}});});}cov_1c7b4pkkzb().s[31]++;intentMap.set('Default Welcome Intent',welcome);cov_1c7b4pkkzb().s[32]++;intentMap.set('Default Fallback Intent',fallback);cov_1c7b4pkkzb().s[33]++;intentMap.set('BookFlight',bookFlight);cov_1c7b4pkkzb().s[34]++;intentMap.set('Getdetails',getdetails);cov_1c7b4pkkzb().s[35]++;agent.handleRequest(intentMap);//});
};cov_1c7b4pkkzb().s[36]++;exports.add=function(req,res){cov_1c7b4pkkzb().f[11]++;var new_product=(cov_1c7b4pkkzb().s[37]++,new Product(req.body));cov_1c7b4pkkzb().s[38]++;new_product.save(function(err,product){cov_1c7b4pkkzb().f[12]++;cov_1c7b4pkkzb().s[39]++;if(err){cov_1c7b4pkkzb().b[3][0]++;cov_1c7b4pkkzb().s[40]++;res.send(err);}else{cov_1c7b4pkkzb().b[3][1]++;}cov_1c7b4pkkzb().s[41]++;res.json(product);});};cov_1c7b4pkkzb().s[42]++;exports.update=function(req,res){cov_1c7b4pkkzb().f[13]++;var id=(cov_1c7b4pkkzb().s[43]++,mongoose.Types.ObjectId(req.query.productId));cov_1c7b4pkkzb().s[44]++;Product.findOneAndUpdate({_id:id},req.body,{new:true},function(err,product){cov_1c7b4pkkzb().f[14]++;cov_1c7b4pkkzb().s[45]++;if(err){cov_1c7b4pkkzb().b[4][0]++;cov_1c7b4pkkzb().s[46]++;res.send(err);}else{cov_1c7b4pkkzb().b[4][1]++;}cov_1c7b4pkkzb().s[47]++;res.json(product);});};cov_1c7b4pkkzb().s[48]++;exports.delete=function(req,res){cov_1c7b4pkkzb().f[15]++;var id=(cov_1c7b4pkkzb().s[49]++,mongoose.Types.ObjectId(req.query.productId));cov_1c7b4pkkzb().s[50]++;Product.remove({_id:id},function(err,product){cov_1c7b4pkkzb().f[16]++;cov_1c7b4pkkzb().s[51]++;if(err){cov_1c7b4pkkzb().b[5][0]++;cov_1c7b4pkkzb().s[52]++;res.send(err);}else{cov_1c7b4pkkzb().b[5][1]++;}cov_1c7b4pkkzb().s[53]++;res.json({message:'Product successfully deleted'});});};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInByb2R1Y3RDb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbImRmZmYiLCJyZXF1aXJlIiwiZXhwcmVzcyIsIldlYmhvb2tDbGllbnQiLCJtb25nb29zZSIsIlByb2R1Y3QiLCJtb2RlbCIsImV4cG9ydHMiLCJwcm9kdWN0cyIsInJlcSIsInJlcyIsImZpbmQiLCJlcnIiLCJwcm9kdWN0Iiwic2VuZCIsImdldHByb2R1Y3QiLCJwcm9kdWN0SWQiLCJxdWVyeSIsImZpbmRCeUlkIiwiVHlwZXMiLCJPYmplY3RJZCIsImpzb24iLCJtcHJvZHVjdCIsImludGVudE1hcCIsIk1hcCIsImFnZW50IiwicmVxdWVzdCIsInJlc3BvbnNlIiwiciIsImJvZHkiLCJxdWVyeVJlc3VsdCIsInBhcmFtZXRlcnMiLCJ3ZWxjb21lIiwiYWRkIiwiYm9va0ZsaWdodCIsImZhbGxiYWNrIiwiZ2V0ZGV0YWlscyIsImZvckVhY2giLCJlbGVtZW50IiwicHJvZHVjdF9uYW1lIiwicHJpY2UiLCJjYXRlZ29yeSIsInNldCIsImhhbmRsZVJlcXVlc3QiLCJuZXdfcHJvZHVjdCIsInNhdmUiLCJ1cGRhdGUiLCJpZCIsImZpbmRPbmVBbmRVcGRhdGUiLCJfaWQiLCJuZXciLCJkZWxldGUiLCJyZW1vdmUiLCJtZXNzYWdlIl0sIm1hcHBpbmdzIjoiQUFBQSxhLHl0UEFlWTsyRkFkWixLQUFNQSxDQUFBQSxJQUFJLDBCQUFHQyxPQUFPLENBQUMsd0JBQUQsQ0FBVixDQUFWLENBQ0EsR0FBSUMsQ0FBQUEsT0FBTywwQkFBR0QsT0FBTyxDQUFDLFNBQUQsQ0FBVixDQUFYLENBQ0E7QUFDQSxLQUFNLENBQUVFLGFBQUYsMkJBQW9CRixPQUFPLENBQUMsd0JBQUQsQ0FBM0IsQ0FBTixDQUNBLEdBQUlHLENBQUFBLFFBQVEsMEJBQUdILE9BQU8sQ0FBQyxVQUFELENBQVYsQ0FBWixDLHdCQUVBSSxPQUFPLENBQUdELFFBQVEsQ0FBQ0UsS0FBVCxDQUFlLFVBQWYsQ0FBVixDLHdCQUNBQyxPQUFPLENB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REFBQUYsR0FBRyxDQUFDSSxJQUFKLENBQVNGLEdBQVQsRUFBYyxDQURsQixpQ0FGbUYseUJBS25GRixHQUFHLENBQUNXLElBQUosQ0FBU1IsT0FBVCxFQUVILENBUEQsRUFTSCxDQWJELEMseUJBZUFOLE9BQU8sQ0FBQzRDLE1BQVIsQ0FBaUIsU0FBVTFDLEdBQVYsQ0FBZUMsR0FBZixDQUFvQiwwQkFFakMsR0FBSXFDLENBQUFBLEVBQUUsMkJBQUczQyxRQUFRLENBQUNlLEtBQVQsQ0FBZUMsUUFBZixDQUF3QlgsR0FBRyxDQUFDUSxLQUFKLENBQVVELFNBQWxDLENBQUgsQ0FBTixDQUZpQyx5QkFJakNYLE9BQU8sQ0FBQytDLE1BQVIsQ0FBZSxDQUFFSCxHQUFHLENBQUVGLEVBQVAsQ0FBZixDQUE0QixTQUFVbkMsR0FBVixDQUFlQyxPQUFmLENBQXdCLG1EQUVoRCxHQUFJRCxHQUFKLENBQ0kscURBQUFGLEdBQUcsQ0FBQ0ksSUFBSixDQUFTRixHQUFULEVBQWMsQ0FEbEIsaUNBRmdELHlCQUtoREYsR0FBRyxDQUFDVyxJQUFKLENBQVMsQ0FBRWdDLE9BQU8sQ0FBRSw4QkFBWCxDQUFULEVBRUgsQ0FQRCxFQVNILENBYkQiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XHJcbmNvbnN0IGRmZmYgPSByZXF1aXJlKCdkaWFsb2dmbG93LWZ1bGZpbGxtZW50Jyk7XHJcbnZhciBleHByZXNzID0gcmVxdWlyZSgnZXhwcmVzcycpO1xyXG4vL2NvbnN0IGZ1bmN0aW9ucyA9IHJlcXVpcmUoJ2ZpcmViYXNlLWZ1bmN0aW9ucycpO1xyXG5jb25zdCB7IFdlYmhvb2tDbGllbnQgfSA9IHJlcXVpcmUoJ2RpYWxvZ2Zsb3ctZnVsZmlsbG1lbnQnKTtcclxudmFyIG1vbmdvb3NlID0gcmVxdWlyZSgnbW9uZ29vc2UnKTtcclxuXHJcblByb2R1Y3QgPSBtb25nb29zZS5tb2RlbCgnUHJvZHVjdHMnKTtcclxuZXhwb3J0cy5wcm9kdWN0cyA9IGZ1bmN0aW9uIChyZXEsIHJlcykge1xyXG5cclxuICAgIFByb2R1Y3QuZmluZChmdW5jdGlvbiAoZXJyLCBwcm9kdWN0KSB7XHJcblxyXG4gICAgICAgIGlmIChlcnIpXHJcbiAgICAgICAgICAgIHJlcy5zZW5kKGVycik7XHJcbiAgICAgICAgcmVzLnNlbmQocHJvZHVjdCk7XHJcblxyXG4gICAgfSk7XHJcblxyXG59O1xyXG5cclxuZXhwb3J0cy5nZXRwcm9kdWN0ID0gZnVuY3Rpb24gKHJlcSwgcmVzKSB7XHJcblxyXG4gICAgdmFyIHByb2R1Y3RJZCA9IHJlcS5xdWVyeS5wcm9kdWN0SWQ7XHJcblxyXG4gICAgUHJvZHVjdC5maW5kQnlJZChtb25nb29zZS5UeXBlcy5PYmplY3RJZChwcm9kdWN0SWQpLCBmdW5jdGlvbiAoZXJyLCBwcm9kdWN0KSB7XHJcblxyXG4gICAgICAgIGlmIChlcnIpXHJcbiAgICAgICAgICAgIHJlcy5zZW5kKGVycik7XHJcbiAgICAgICAgcmVzLmpzb24ocHJvZHVjdCk7XHJcblxyXG4gICAgfSk7XHJcblxyXG59O1xyXG5cclxuXHJcbmV4cG9ydHMubXByb2R1Y3QgPSBmdW5jdGlvbiAocmVxLCByZXMpIHtcclxuICAgIHZhciBpbnRlbnRNYXAgPSBuZXcgTWFwKCk7XHJcbiAgIFxyXG4gICAgY29uc3QgYWdlbnQgPSBuZXcgZGZmZi5XZWJob29rQ2xpZW50KHsgcmVxdWVzdDogcmVxLCByZXNwb25zZTogcmVzIH0pO1xyXG4gICAgXHJcbiAgICBsZXQgcj1yZXEuYm9keS5xdWVyeVJlc3VsdC5wYXJhbWV0ZXJzLnByb2R1Y3Q7XHJcbiAgICAvL1Byb2R1Y3QuZmluZChmdW5jdGlvbiAoZXJyLCBwcm9kdWN0KSB7XHJcbiAgICAgICAgZnVuY3Rpb24gd2VsY29tZShhZ2VudCkge1xyXG4gICAgICAgICAgICBhZ2VudC5hZGQoXCJXZWxjb21lLCBJbSBhIG9ubGluZXN0b3JlIGFnZW50IS4gd2hpY2ggcGhvbmUgeW91IHdhbnQgdG8gY2hvb3NlP1wiKTtcclxuICAgICAgICAgICAgLy8gcHJvZHVjdC5mb3JFYWNoKGVsZW1lbnQgPT4ge1xyXG4gICAgICAgICAgICAvLyAgICAgLy9jb25zb2xlLmxvZyhlbGVtZW50LnByaWNlKTtcclxuICAgICAgICAgICAgLy8gICAgIGFnZW50LmFkZChlbGVtZW50LnByb2R1Y3RfbmFtZSk7XHJcbiAgICAgICAgICAgIC8vIH0pO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGJvb2tGbGlnaHQoYWdlbnQpIHtcclxuICAgICAgICAgICAgYWdlbnQuYWRkKFwiaGVsbG9cIilcclxuICAgICAgICAgICAgLy9hZ2VudC5hZGQocHJvZHVjdCk7XHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZmFsbGJhY2soYWdlbnQpIHtcclxuICAgICAgICAgICAgYWdlbnQuYWRkKFwiSSBkaWRuJ3QgdW5kZXJzdGFuZFwiKTtcclxuICAgICAgICAgICAgYWdlbnQuYWRkKFwiSSdtIHNvcnJ5LCBjYW4geW91IHRyeSBhZ2Fpbj9cIik7XHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZ2V0ZGV0YWlscyhhZ2VudCkge1xyXG4gICAgICAgICAgICBhZ2VudC5hZGQoXCJJcGhvbmVcIik7XHJcbiAgICAgICAgICAgIFByb2R1Y3QuZmluZCh7IFwicHJvZHVjdF9uYW1lXCI6IHIgfSwgZnVuY3Rpb24gKGVyciwgcHJvZHVjdCkge1xyXG4gICAgICAgICAgICBwcm9kdWN0LmZvckVhY2goZWxlbWVudCA9PiB7XHJcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKGVsZW1lbnQucHJpY2UpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQucHJvZHVjdF9uYW1lID09PSByKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWdlbnQuYWRkKFwiTmFtZTogXCIrZWxlbWVudC5wcm9kdWN0X25hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGFnZW50LmFkZChcIlByaWNlOiBcIitlbGVtZW50LnByaWNlKTtcclxuICAgICAgICAgICAgICAgICAgICBhZ2VudC5hZGQoXCJDYXRlZ29yeTogXCIrZWxlbWVudC5jYXRlZ29yeSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgaW50ZW50TWFwLnNldCgnRGVmYXVsdCBXZWxjb21lIEludGVudCcsIHdlbGNvbWUpO1xyXG4gICAgICAgIGludGVudE1hcC5zZXQoJ0RlZmF1bHQgRmFsbGJhY2sgSW50ZW50JywgZmFsbGJhY2spO1xyXG4gICAgICAgIGludGVudE1hcC5zZXQoJ0Jvb2tGbGlnaHQnLCBib29rRmxpZ2h0KTtcclxuICAgICAgICBpbnRlbnRNYXAuc2V0KCdHZXRkZXRhaWxzJywgZ2V0ZGV0YWlscyk7XHJcbiAgICAgICAgYWdlbnQuaGFuZGxlUmVxdWVzdChpbnRlbnRNYXApO1xyXG5cclxuICAgIC8vfSk7XHJcblxyXG5cclxufVxyXG5cclxuZXhwb3J0cy5hZGQgPSBmdW5jdGlvbiAocmVxLCByZXMpIHtcclxuXHJcbiAgICB2YXIgbmV3X3Byb2R1Y3QgPSBuZXcgUHJvZHVjdChyZXEuYm9keSk7XHJcblxyXG4gICAgbmV3X3Byb2R1Y3Quc2F2ZShmdW5jdGlvbiAoZXJyLCBwcm9kdWN0KSB7XHJcblxyXG4gICAgICAgIGlmIChlcnIpXHJcbiAgICAgICAgICAgIHJlcy5zZW5kKGVycik7XHJcblxyXG4gICAgICAgIHJlcy5qc29uKHByb2R1Y3QpO1xyXG5cclxuICAgIH0pO1xyXG5cclxufTtcclxuXHJcblxyXG5cclxuZXhwb3J0cy51cGRhdGUgPSBmdW5jdGlvbiAocmVxLCByZXMpIHtcclxuXHJcbiAgICB2YXIgaWQgPSBtb25nb29zZS5UeXBlcy5PYmplY3RJZChyZXEucXVlcnkucHJvZHVjdElkKTtcclxuXHJcbiAgICBQcm9kdWN0LmZpbmRPbmVBbmRVcGRhdGUoeyBfaWQ6IGlkIH0sIHJlcS5ib2R5LCB7IG5ldzogdHJ1ZSB9LCBmdW5jdGlvbiAoZXJyLCBwcm9kdWN0KSB7XHJcblxyXG4gICAgICAgIGlmIChlcnIpXHJcbiAgICAgICAgICAgIHJlcy5zZW5kKGVycik7XHJcblxyXG4gICAgICAgIHJlcy5qc29uKHByb2R1Y3QpO1xyXG5cclxuICAgIH0pO1xyXG5cclxufTtcclxuXHJcbmV4cG9ydHMuZGVsZXRlID0gZnVuY3Rpb24gKHJlcSwgcmVzKSB7XHJcblxyXG4gICAgdmFyIGlkID0gbW9uZ29vc2UuVHlwZXMuT2JqZWN0SWQocmVxLnF1ZXJ5LnByb2R1Y3RJZCk7XHJcblxyXG4gICAgUHJvZHVjdC5yZW1vdmUoeyBfaWQ6IGlkIH0sIGZ1bmN0aW9uIChlcnIsIHByb2R1Y3QpIHtcclxuXHJcbiAgICAgICAgaWYgKGVycilcclxuICAgICAgICAgICAgcmVzLnNlbmQoZXJyKTtcclxuXHJcbiAgICAgICAgcmVzLmpzb24oeyBtZXNzYWdlOiAnUHJvZHVjdCBzdWNjZXNzZnVsbHkgZGVsZXRlZCcgfSk7XHJcblxyXG4gICAgfSk7XHJcblxyXG59OyJdfQ==